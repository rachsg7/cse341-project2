<%- include('../includes/head.ejs') %>
    <%- include('../includes/nav.ejs') %>
        <main>
            <div class="main_width">
                <div class="profile_header">
                    <img class="profile_img" src="/<%= profileUser.profileImgUrl %>">
                    <div class="user_name">
                        <%= username %>
                    </div>
                    <% if(canEdit) { %>
                        <span class="user_edit_box"><a class="btn user_edit" href="/edit-profile">Edit Profile</a>
                        <a class="btn user_edit" href="/feed">My Feed</a></span>
                        <% } else { %>
                            <span class="user_edit_box">
                                <% if(!isFollowing) { %>
                                <form action="/follow" method="post">
                                    <button class="btn" type="submit">Follow</button>
                                    <input type="hidden" name="userId" value="<%= profileUser._id %>">
                                </form>
                                <% } else { %>
                                    <form action="/unfollow" method="post">
                                        <button class="btn" type="submit">Unfollow</button>
                                        <input type="hidden" name="userId" value="<%= profileUser._id %>">
                                    </form>
                                    <% } %>
                            </span>
                            <% } %>
                                <p class="user_bio">
                                    <%= profileUser.bio %>
                                </p>
                                <span><a href="/following/<%= profileUser._id %>" class="link"><strong>Following: </strong>
                        <%= following %>
                    </a></span>
                </div>
                <ul class="gallery">
                    <!-- <% var max = 50;
                        for (var i = 0; i < max; i++){ 
                        var w = Math.floor(Math.random() * (5 - 2) + 2)*100;
                        var h = Math.floor(Math.random() * (5 - 2) + 2)*100;%>
                        <li><a href="#<%= i %>"><img src="https://source.unsplash.com/random/<%= w %>x<%= h %>?sig=<%= i %>" loading="lazy"></a></li>
                        <% } %> -->
                    <%if(!posts && canEdit) { %>
                        <h1>Nothing to See! Add a Post?</h1>
                    <% } else if(!posts) { %>
                        <h1>Nothing to see here.</h1>
                    <% } else { %>
                        <% for (let i = posts.length - 1; i >= 0; i--){ %>
                            <div class="feed">
                                <a href="../../postDetails/<%= posts[i]._id %>">
                                    <img src="/<%= posts[i].image %>" loading="lazy">
                                </a>
                                <div class="feed_lower">
                                    <div class="icon__left">
                                        <% if(liked[i]){ %>
                                            <i class="fa fa-heart fa-2x"></i>
                                        <% }else{ %>
                                            <a href="../like/<%= posts[i]._id %>/<%= profileUser._id %>"><i class="far fa-heart fa-2x"></i></a>
                                        <% } %>
                                        <a href="../comment/<%= posts[i]._id %>"><i class="far fa-comment fa-2x"></i></a>
                                    </div>
                                    <span class="icon__text">&nbsp;Likes: <%= likes[i]%>
                            </span>
                                    <div class="icon__right">
                                        <% if(canEdit){ %>
                                            <a href="../edit/<%= post._id %>"><i class="far fa-edit fa-2x"></i></a>
                                        <% } %>
                                    </div>
                                </div>
                            </div>
                        <% } %>
                    <% } %>
                </ul>
            </div>
        </main>
        <%- include('../includes/end.ejs') %>